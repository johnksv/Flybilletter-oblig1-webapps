@model Flybilletter.Models.Bestilling

<script>
    $(function () {
        $('#gaaTilAvbestill').click(function () {
            $("#avbestill").modal();
        });
    });
</script>

@if (Model == null)
{

    <h3>Referansen finnes ikke i databasen</h3>
    return;
}

@{
    var fraFlyplass = Model.Flygninger.First().Rute.Fra;
    var tilFlyplass = @Model.Flygninger.Last().Rute.Til;
    var bestillingsTidspunkt = Model.BestillingsTidspunkt;
}

<div>
    <h3>Referanse: @Html.DisplayFor(model => model.Referanse)</h3>
    <h4>Din reise fra @fraFlyplass.By (@fraFlyplass.ID) til @tilFlyplass.By (@tilFlyplass.ID)</h4>
    <div>
        <label>Tidspunkt for bestilling: </label>
        @Html.DisplayFor(model => model.BestillingsTidspunkt)
    </div>
    <hr />

    <h4>Flygninger</h4>
    
    @for (int i = 0; i < Model.Flygninger.Count; i++)
    {
        @Html.DisplayFor(model => model.Flygninger[i], new { htmlAttributes = new { @class = "form-control" } })
    }


    <h4>Passasjerer</h4>
    <div class="row">
        @for (int i = 0, antall = 1; i < Model.Passasjerer.Count; i++, antall++)
        {
            <div class="col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Passasjer @antall</h3>
                    </div>
                    <div class="panel-body">
                        @Html.DisplayFor(model => model.Passasjerer[i], new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            </div>
        }
    </div>

    @if (bestillingsTidspunkt > DateTime.Today.AddDays(-2))
    {
        <a href="#avbestill" id="gaaTilAvbestill" class="btn btn-danger" >Avbestill reise</a>
    }

    <div class="modal" id="avbestill" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Du er i ferd med å avbestille reisen. Er du sikker?</h3>
                </div>
                <div class="modal-body">
                    <a href="/Home/Avbestill?referanse=@Model.Referanse" class="btn btn-danger">Avbestill reise</a>
                    <a class="btn btn-primary" data-dismiss="modal">Avbryt</a>
                </div>
            </div>
        </div>
    </div>
</div>
